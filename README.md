# js-base
Basic knowledge analysis of javascript

# http（无处安放，又无法写底层原理，so…）
[参考链接。](https://juejin.im/post/5e8c852f6fb9a03c5a7a98d9)  
以下仅为个人理解，如有不对，感谢及时提出，让我进步。详细还是需要看参考资料，写的很好。

## Q: 从输入URL到页面加载完成的过程中都发生了啥
### 大体分析
- 首先，输入的是比如：https://juejin.im，接收到的是展示界面
- DNS解析：DNS(Domain Name System)。 输入的`url`是方便记忆，真实存在服务器中的地址并不是`url`展示出来的，例如本地中`localhost`对应的其实是`127.0.0.1`，`localhost`就是域名，`127.0.0.1`本地IP。所谓DNS解析根据远程服务器域名映射表例如： {localhost: `127.0.0.1`}，分析出真正的IP地址返回。

#### 建立连接

- 三次握手。所谓三次握手是为建立连接做准备，。以打电话例子方式解释
> C: hi，我是客户端，听得到吗？(request header)  
S: hi，我是服务端，可以听到，你可以听到我讲话吗？(response header)  
C: 收到，可以听到，给你说个事！(request data)


#### 四次挥手  
> C: 我说完了，挂了啊(requested data)  
S: 别介。你说的我记住了，但是我还有事跟你讲(got response body, and will send data)  
much time later  
S: 好了，我说完了，我挂了哈（通知中，并未挂）  (sent data)  
C: 好了，我记住了，你挂吧（S收到后直接挂了，C还等了`2MSL`挂掉），至此断开连接 

说道这里，是不很像谈对象或者其他场景中，客户端就像男方（追求方或爱的多的或体贴的或细腻的或付出多的），服务端就像女方（被追求方或不在意的或大咧性格的）。呸，跑偏了

#### 为什么是三次握手？而不是二次四次
> 假如两次。  
客户端说，hi，然后没信号了，后面两句服务端没听到，  
服务端无法回复，甚至会破口大骂，你谁啊，hi个屁，喂？？？，至此就没有下文了  
假如四次。什么？你还指望四次？你还指望女方再给你回复？ 呸，回归正文，四次就多余了呀，浪费流量浪费时间。  

#### 为什么是四次挥手，而不是建立连接的三次
> 需要使用链接解释了。TCP属于双共模式。就是说客户端发起请求必须服务端确认，同理服务端传输数据也必须客户端确认才可释放链接。而建立连接的不涉及到数据变动，所以二三可合并。

#### 最后一次握手后A为什么要等2MSL？
> 首先解释一下MSL，MSL是指最长报文段寿命，RFC793建议为两分钟，但实际上可据实际情况而定，也就是说一个报文段最久可存在的时间是MSL
1. 保证客户端最后一个信息抵达服务端，如果服务端未收到，则超时重连第三次握手，客户端收到再次传输数据，并且重新启动2MSL计时器，
> 专业接力解释：最终结果是A和B都正常进入CLOSE状态。如果A发完ACK报文后就直接释放了A-->B的连接，那么A就收不到B重传的FIN+ACK报文，也不能重新发送ACK`报文，那么B就无法按正常步骤释放B-->A的连接
2. 防止“已失效的连接请求报文”出现在下一个新的连接中，因为一个报文段的寿命是MSL，所以A在发送完最后一个ACK报文段之后，再经过时间2MSL，本连接持续的时间内所产生的所有报文段都将在网络中消失，这样这些旧的报文段便不会出现在下一个新的连接中
### answer总结
1. dns域名解析，找到端口，返回地址。
2. 浏览器根据地址发起`get`请求，进行三次握手、四次挥手。返回`html+css+script`之类
3. 浏览器解析`html`，渲染`html`，装修`html`即`css`，再是`script`。
> `html`渲染，遵循`dom tree`渲染，先父级再子级。`html`结构出来，css再根据节点查找渲染样式。最后执行`script`
